(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 13.3' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     43489,       1045]
NotebookOptionsPosition[     41435,       1007]
NotebookOutlinePosition[     41902,       1025]
CellTagsIndexPosition[     41859,       1022]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[{
 RowBox[{
  RowBox[{"Needs", "[", "\"\<NDSolve`FEM`\>\"", "]"}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"eps0", "=", "0.00858541878128"}], ";"}], 
  RowBox[{"(*", 
   RowBox[{
   "Permittivity", " ", "of", " ", "Free", " ", "Space", " ", "in", " ", 
    "picofarads", " ", "per", " ", "mm"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"eps1", " ", "=", " ", "1"}], ";"}], " ", 
  RowBox[{"(*", 
   RowBox[{"Relative", " ", "Permittivity", " ", "of", " ", "glass"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"eq", "=", 
    RowBox[{
     RowBox[{"Div", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"(", "eps0", " ", ")"}], "*", 
        RowBox[{"Grad", "[", 
         RowBox[{
          RowBox[{"u", "[", 
           RowBox[{"x", ",", "y", ",", "z"}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"x", ",", "y", ",", "z"}], "}"}]}], "]"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"x", ",", "y", ",", "z"}], "}"}]}], "]"}], "\[Equal]", 
     "0"}]}], ";"}], " ", 
  RowBox[{"(*", 
   RowBox[{
   "Poisson", " ", "equation", " ", "describing", " ", "the", " ", "partial", 
    " ", "differential", " ", "equation", " ", "to", " ", "be", " ", "solved",
     " ", "to", " ", "find", " ", "the", " ", "electric", " ", "potential", 
    " ", "within", " ", "the", " ", "\"\<mesh\>\"", " ", "volume"}], 
   "*)"}]}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"V1", "=", "1.2"}], ";", 
   RowBox[{"V2", "=", "0"}], ";"}], " ", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "voltage", " ", "applied", " ", "to", " ", "excitation", " ", 
     "electrode"}], ",", " ", 
    RowBox[{"ground", " ", "reference"}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"Define", " ", "boundaries"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"Volume", " ", "of", " ", "Mesh"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"azmin", "=", "0"}], ";", 
   RowBox[{"azmax", "=", "100"}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"Electrode", " ", "geometry"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"r", "=", "175"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"air", "=", 
   RowBox[{"Cylinder", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "azmin"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "azmax"}], "}"}]}], "}"}], ",", "r"}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"bmesh", "=", 
    RowBox[{"ToBoundaryMesh", "[", 
     RowBox[{"air", ",", 
      RowBox[{"MaxCellMeasure", "->", "80"}]}], "]"}]}], " ", ";"}], 
  RowBox[{"(*", 
   RowBox[{"create", " ", "a", " ", "boundary", " ", "mesh"}], "*)"}]}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"mesh", "=", 
    RowBox[{"ToElementMesh", "[", 
     RowBox[{"bmesh", ",", 
      RowBox[{"MaxCellMeasure", "->", "80"}]}], "]"}]}], ";"}], 
  RowBox[{"(*", 
   RowBox[{
   "create", " ", "an", " ", "element", " ", "mesh", " ", "and", " ", 
    "visualize"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{"mesh", "[", "\"\<Wireframe\>\"", "]"}]}], "Input",
 CellChangeTimes->{{3.895057748969425*^9, 3.895057808207815*^9}, {
   3.895072391372954*^9, 3.8950725721879296`*^9}, {3.8950729527491045`*^9, 
   3.895072955405086*^9}, {3.895073072050782*^9, 3.895073093083055*^9}, {
   3.895073195563673*^9, 3.895073197864968*^9}, {3.8950742079102373`*^9, 
   3.8950742084399614`*^9}, {3.896794910371753*^9, 3.8967949877117248`*^9}, {
   3.8967950272097583`*^9, 3.896795030138543*^9}, {3.896795108198325*^9, 
   3.8967951199960985`*^9}, {3.896807921990051*^9, 3.8968079227595797`*^9}, {
   3.8968079578033*^9, 3.8968079899956093`*^9}, {3.8987882964618635`*^9, 
   3.8987883801609726`*^9}, {3.8987884378122363`*^9, 3.898788455828697*^9}, {
   3.8987885919906406`*^9, 3.898788596738743*^9}, {3.898788668993633*^9, 
   3.898788679725917*^9}, {3.898791361623478*^9, 3.898791393981413*^9}, 
   3.898791806392716*^9, {3.8987920842932243`*^9, 3.898792084454211*^9}, {
   3.898792221016076*^9, 3.898792221157027*^9}, {3.916250276664846*^9, 
   3.916250296682678*^9}, {3.9163106837122183`*^9, 3.9163107015291376`*^9}, {
   3.9163108007852325`*^9, 3.9163108104307985`*^9}, {3.9163122703448467`*^9, 
   3.9163122816757216`*^9}, {3.9172091265994124`*^9, 
   3.9172091444685197`*^9}, {3.9172091767384024`*^9, 3.9172091769102373`*^9}, 
   3.917262310811304*^9, {3.9172684346525297`*^9, 3.917268434734482*^9}, 
   3.917268480444121*^9, {3.9172685839452105`*^9, 3.9172685906763315`*^9}, {
   3.917268696875253*^9, 3.9172687017640386`*^9}, {3.9172689434841986`*^9, 
   3.91726894992196*^9}, {3.917269069486827*^9, 3.9172690737915535`*^9}, {
   3.917270985734251*^9, 3.917271013440363*^9}, {3.9172710484937563`*^9, 
   3.9172710486755276`*^9}, {3.917274812923272*^9, 3.917274813056313*^9}, {
   3.9172821001889277`*^9, 3.9172821039191337`*^9}, {3.9172834843321824`*^9, 
   3.9172834964569006`*^9}, {3.917283785320912*^9, 3.917283801011643*^9}, {
   3.9173808893654137`*^9, 3.9173808896416955`*^9}, 3.9204029646415544`*^9, {
   3.920403123346863*^9, 
   3.92040313179856*^9}},ExpressionUUID->"f26d7497-0a07-45ef-90a2-\
712c1a135654"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "define", " ", "arc", " ", "length", " ", "of", " ", "electrodes"}], 
   "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"arc", "=", 
    RowBox[{"20", 
     FractionBox["Pi", "180"]}]}], ";"}]}]], "Input",
 CellChangeTimes->{{3.898788790690647*^9, 3.898788799698697*^9}, {
  3.8987888806429014`*^9, 3.8987888869024696`*^9}, {3.9162554540725574`*^9, 
  3.916255459905566*^9}, {3.9163107118113346`*^9, 3.91631071220712*^9}, {
  3.916346850129833*^9, 3.916346857310672*^9}, {3.917209230459446*^9, 
  3.917209232562476*^9}, {3.9201081217406225`*^9, 
  3.9201081354721375`*^9}},ExpressionUUID->"1db33636-8368-4bc8-8f65-\
a9dcdd91192b"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "define", " ", "array", " ", "of", " ", "boundary", " ", "conditions", 
     " ", "for", " ", "each", " ", "of", " ", "the", " ", "16", " ", 
     RowBox[{"electrodes", ".", " ", "Not"}], " ", "general"}], "-", 
    RowBox[{
    "only", " ", "works", " ", "for", " ", "16", " ", "electrodes"}]}], 
   "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"bcarray", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"DirichletCondition", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"u", "[", 
             RowBox[{"x", ",", "y", ",", "z"}], "]"}], "==", "V1"}], ",", 
           RowBox[{
            RowBox[{"RegionMember", "[", 
             RowBox[{
              RowBox[{"Annulus", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"0", ",", "0"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"r", "-", "0.01"}], ",", "r"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"offangle", ",", 
                  RowBox[{"arc", "+", "offangle"}]}], "}"}]}], "]"}], ",", 
              RowBox[{"{", 
               RowBox[{"x", ",", "y"}], "}"}]}], "]"}], "&&", 
            RowBox[{"0", "<=", "z", "<=", "azmax"}]}]}], "]"}], ",", 
         RowBox[{"DirichletCondition", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"u", "[", 
             RowBox[{"x", ",", "y", ",", "z"}], "]"}], "==", "V2"}], ",", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"RegionMember", "[", 
                RowBox[{
                 RowBox[{"Annulus", "[", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{"0", ",", "0"}], "}"}], ",", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"r", "-", "0.01"}], ",", "r"}], "}"}], ",", 
                   RowBox[{"{", 
                    RowBox[{"0", ",", "offangle"}], "}"}]}], "]"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"x", ",", "y"}], "}"}]}], "]"}], "&&", 
               RowBox[{"RegionMember", "[", 
                RowBox[{
                 RowBox[{"Annulus", "[", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{"0", ",", "0"}], "}"}], ",", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"r", "-", "0.01"}], ",", "r"}], "}"}], ",", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"offangle", "+", "arc"}], ",", 
                    RowBox[{"2", " ", "Pi"}]}], "}"}]}], "]"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"x", ",", "y"}], "}"}]}], "]"}]}], ")"}], "&&", 
             RowBox[{"0", "<=", "z", "<=", "azmax"}]}], "||", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"z", "==", "azmin"}], "&&", 
              RowBox[{"RegionMember", "[", 
               RowBox[{
                RowBox[{"Disk", "[", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{"0", ",", "0"}], "}"}], ",", 
                  RowBox[{"r", "-", "0.01"}]}], "]"}], ",", 
                RowBox[{"{", 
                 RowBox[{"x", ",", "y"}], "}"}]}], "]"}]}], ")"}], "||", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"z", "==", "azmax"}], "&&", 
              RowBox[{"RegionMember", "[", 
               RowBox[{
                RowBox[{"Disk", "[", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{"0", ",", "0"}], "}"}], ",", 
                  RowBox[{"r", "-", "0.01"}]}], "]"}], ",", 
                RowBox[{"{", 
                 RowBox[{"x", ",", "y"}], "}"}]}], "]"}]}], ")"}]}]}], 
          "]"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"offangle", ",", "0", ",", 
         RowBox[{
          RowBox[{"2", " ", "Pi"}], "-", "arc"}], ",", 
         RowBox[{"Pi", "/", "8"}]}], "}"}]}], "]"}]}], ";"}], 
   "\n"}]}]], "Input",
 CellChangeTimes->{{3.916268351818593*^9, 3.9162683518195953`*^9}, {
  3.9163109113967237`*^9, 3.916310922586277*^9}, {3.916346951735574*^9, 
  3.9163469719378214`*^9}, {3.91720930216346*^9, 3.9172093025690894`*^9}, {
  3.920108139115588*^9, 3.9201081547661495`*^9}, {3.9201083211419687`*^9, 
  3.9201083245510826`*^9}},ExpressionUUID->"e784b316-4fa1-4a69-b781-\
ec7c27e6dae1"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"visualize", " ", "the", " ", "electrode", " ", "placements"}], 
    "-", 
    RowBox[{"not", " ", "strictly", " ", "necessary"}]}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"Graphics", "[", 
    RowBox[{
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"FaceForm", "[", "None", "]"}], ",", 
         RowBox[{"EdgeForm", "[", 
          RowBox[{"Directive", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"ColorData", "[", "97", "]"}], "[", "i", "]"}], ",", 
            "Thick"}], "]"}], "]"}], ",", 
         RowBox[{"Annulus", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"0", ",", "0"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"r", "-", "0.01"}], ",", "r"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"offangle", ",", 
             RowBox[{"offangle", "+", "arc"}]}], "}"}]}], "]"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", 
         RowBox[{"Length", "[", "bcarray", "]"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"offangle", ",", "0", ",", 
         RowBox[{
          RowBox[{"2", " ", "Pi"}], "-", "arc"}], ",", 
         FractionBox["Pi", "8"]}], "}"}]}], "]"}], ",", 
     RowBox[{"Frame", "->", "True"}], ",", 
     RowBox[{"PlotRange", "->", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "r"}], "-", "1"}], ",", 
          RowBox[{"r", "+", "1"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "r"}], "-", "1"}], ",", 
          RowBox[{"r", "+", "1"}]}], "}"}]}], "}"}]}]}], "]"}], 
   "\n"}]}]], "Input",
 CellChangeTimes->{{3.9162614641818295`*^9, 3.9162614915206003`*^9}, {
   3.916261585468775*^9, 3.9162615857494926`*^9}, 3.916347010059539*^9, {
   3.917209253423174*^9, 3.91720925392531*^9}, {3.9201080968702993`*^9, 
   3.9201081174839883`*^9}},ExpressionUUID->"c0d84ba2-6dec-4d4c-a0a7-\
633e9cb56c48"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "solve", " ", "the", " ", "Poisson", " ", "equation", " ", "over", " ", 
    "the", " ", "mesh", " ", "for", " ", "each", " ", "of", " ", "the", " ", 
    "electrodes"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"Uarray", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"NDSolveValue", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"eq", ",", 
           RowBox[{"bcarray", "[", 
            RowBox[{"[", "i", "]"}], "]"}]}], "}"}], ",", "u", ",", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"x", ",", "y", ",", "z"}], "}"}], "\[Element]", "mesh"}]}],
         "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", "16", ",", "1"}], "}"}]}], "]"}]}], ";"}],
    "//", "AbsoluteTiming"}]}]], "Input",
 CellChangeTimes->{{3.898789296132549*^9, 3.8987893100575275`*^9}, {
   3.8987893618003674`*^9, 3.898789370457163*^9}, {3.9163109903412333`*^9, 
   3.9163109904854555`*^9}, {3.9172094609418373`*^9, 
   3.9172094613336515`*^9}, {3.9172095435045986`*^9, 
   3.9172095436692686`*^9}, {3.9172714030512257`*^9, 3.9172714035110445`*^9}, 
   3.9172751776164875`*^9, {3.917275208064438*^9, 3.9172752085506372`*^9}, {
   3.9172856053352847`*^9, 3.9172856058775325`*^9}, {3.9201081595734854`*^9, 
   3.9201081905757933`*^9}, {3.920402996897434*^9, 
   3.920403000119501*^9}},ExpressionUUID->"4e29b1e1-09ae-4d27-bea7-\
d54cbcf6a274"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"622.1835995`", ",", "Null"}], "}"}]], "Output",
 CellChangeTimes->{3.917213562832434*^9, 3.917272554449896*^9, 
  3.9172750331691666`*^9, 3.917275414412547*^9, 3.9172840581736403`*^9, 
  3.917285919002371*^9, 3.917311600112971*^9, 3.917955116232256*^9},
 CellLabel->"Out[15]=",ExpressionUUID->"a266469a-358b-4ce5-b755-2f3f4f237f5e"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "visualize", " ", "the", " ", "first", " ", "electrode", " ", "potential",
      " ", "in", " ", "an", " ", "axial", " ", "slice", " ", "of", " ", "the",
      " ", "mesh", " ", 
     RowBox[{"volume", ".", " ", "Again"}]}], "-", " ", 
    RowBox[{
    "not", " ", "necessary", " ", "but", " ", "helps", " ", "to", " ", 
     "visualize", " ", "the", " ", "electric", " ", 
     RowBox[{"field", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"ContourPlot", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"Uarray", "[", 
       RowBox[{"[", "1", "]"}], "]"}], "[", 
      RowBox[{"x", ",", "y", ",", 
       RowBox[{"azmax", "/", "2"}]}], "]"}], ",", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"x", ",", "y"}], "}"}], "\[Element]", 
      RowBox[{"Disk", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"0", ",", "0"}], "}"}], ",", "r"}], "]"}]}], ",", 
     RowBox[{"AxesLabel", "->", "Automatic"}], ",", 
     RowBox[{"ColorFunction", "->", "\"\<Rainbow\>\""}], ",", 
     RowBox[{"Contours", "->", "10"}]}], "]"}], "\n"}]}]], "Input",
 CellChangeTimes->{{3.916252449591518*^9, 3.9162524495922475`*^9}, {
   3.9162684239484377`*^9, 3.916268434378947*^9}, {3.9162690355637765`*^9, 
   3.916269041048005*^9}, {3.9162690890144663`*^9, 3.9162691188451943`*^9}, 
   3.916269206454858*^9, {3.9163098231094427`*^9, 3.9163099257717285`*^9}, {
   3.9163109708026714`*^9, 3.9163109711930995`*^9}, {3.916347218195653*^9, 
   3.916347223900612*^9}, {3.9172236513072577`*^9, 3.917223686628768*^9}, 
   3.9172743190049934`*^9, {3.920108196841113*^9, 3.9201082372176113`*^9}, {
   3.92040351580396*^9, 
   3.9204035363476543`*^9}},ExpressionUUID->"49f166a6-2040-4495-af71-\
4deb41679c49"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "define", " ", "an", " ", "array", " ", "that", " ", "holds", " ", "the", 
     " ", "unique", " ", "electrode", " ", "combinations", " ", "for", " ", 
     "a", " ", "16", " ", "electrode", " ", 
     RowBox[{"sensor", ".", " ", "Not"}], " ", "a", " ", "general", " ", 
     "approach"}], "-", 
    RowBox[{
    "only", " ", "works", " ", "for", " ", "16", " ", "electrodes"}]}], 
   "*)"}], "\[IndentingNewLine]", 
  RowBox[{"pattern", "=", 
   RowBox[{"Flatten", "[", 
    RowBox[{
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"i", ",", "j"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", "15"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"j", ",", 
         RowBox[{"i", "+", "1"}], ",", "16"}], "}"}]}], "]"}], ",", "1"}], 
    "]"}]}]}]], "Input",
 CellChangeTimes->{{3.9172861654604645`*^9, 3.917286188267973*^9}, {
  3.917286249057598*^9, 3.917286272254757*^9}, {3.9172889844273095`*^9, 
  3.9172890050768723`*^9}, {3.920108253861514*^9, 3.9201083045150414`*^9}, {
  3.9204030260476627`*^9, 
  3.9204030310484624`*^9}},ExpressionUUID->"909a61a5-e4b5-4da4-9835-\
8bda6d13342a"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "Take", " ", "the", " ", "dot", " ", "product", " ", "of", " ", "the", 
     " ", "gradient", " ", "of", " ", "the", " ", "unique", " ", "electrode", 
     " ", "combinations", " ", "for", " ", "a", " ", "16", " ", "electrode", 
     " ", 
     RowBox[{"sensor", ".", " ", "Not"}], " ", "a", " ", "general", " ", 
     "approach"}], "-", 
    RowBox[{
    "only", " ", "works", " ", "for", " ", "16", " ", "electrodes", "*"}]}], 
   "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"patternarray", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{
        FractionBox[
         RowBox[{"-", "1"}], 
         SuperscriptBox["V1", "2"]], 
        RowBox[{"Dot", "[", 
         RowBox[{
          RowBox[{"Grad", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Uarray", "[", 
              RowBox[{"[", 
               RowBox[{
                RowBox[{"pattern", "[", 
                 RowBox[{"[", "i", "]"}], "]"}], "[", 
                RowBox[{"[", "1", "]"}], "]"}], "]"}], "]"}], "[", 
             RowBox[{"x", ",", "y", ",", "z"}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"x", ",", "y", ",", "z"}], "}"}]}], "]"}], ",", 
          RowBox[{"Grad", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Uarray", "[", 
              RowBox[{"[", 
               RowBox[{
                RowBox[{"pattern", "[", 
                 RowBox[{"[", "i", "]"}], "]"}], "[", 
                RowBox[{"[", "2", "]"}], "]"}], "]"}], "]"}], "[", 
             RowBox[{"x", ",", "y", ",", "z"}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"x", ",", "y", ",", "z"}], "}"}]}], "]"}]}], "]"}]}], 
       ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", "120"}], "}"}]}], "]"}]}], ";"}], "//", 
   "AbsoluteTiming"}]}]], "Input",
 CellChangeTimes->{{3.9159904368896255`*^9, 3.915990467699723*^9}, {
   3.916307661990409*^9, 3.916307697982307*^9}, {3.9163080865248003`*^9, 
   3.916308098441065*^9}, {3.916309890664963*^9, 3.9163098908136673`*^9}, {
   3.9163113518803883`*^9, 3.9163113550098295`*^9}, {3.9172743397297664`*^9, 
   3.917274340311489*^9}, {3.9172809664472275`*^9, 3.9172809668667545`*^9}, {
   3.917284106047567*^9, 3.9172841932971087`*^9}, {3.9172852982407417`*^9, 
   3.9172853010058866`*^9}, {3.9172854921075397`*^9, 
   3.9172855329811664`*^9}, {3.917285568694703*^9, 3.91728558840084*^9}, {
   3.917286058000555*^9, 3.9172861358491273`*^9}, {3.917286291526847*^9, 
   3.9172862926166077`*^9}, {3.917289049833004*^9, 3.9172890923854275`*^9}, {
   3.920108342500786*^9, 3.9201083745911727`*^9}, 
   3.9204030606605606`*^9},ExpressionUUID->"d0eb7bf3-dbba-426c-a3c7-\
465c623d1e52"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "Initialize", " ", "reinmann", " ", "sum", " ", "parameters", " ", "and", 
    " ", "define", " ", "a", " ", "voxel", " ", "grid", " ", "over", " ", 
    "which", " ", "to", " ", "sum"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"dxx", "=", "3.5"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"dyy", "=", "3.5"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"s1xvoxgrid", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"xi", ",", "yi"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"xi", ",", 
         RowBox[{"-", "r"}], ",", 
         RowBox[{"r", "-", "dxx"}], ",", "dxx"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"yi", ",", 
         RowBox[{"-", "r"}], ",", 
         RowBox[{"r", "-", "dyy"}], ",", "dyy"}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
     "using", " ", "dimensions", " ", "of", " ", "the", " ", "voxel", " ", 
      "grid"}], ",", " ", 
     RowBox[{
     "create", " ", "an", " ", "array", " ", "of", " ", "2", "x2", " ", 
      "coordinates", " ", "per", " ", "voxel", " ", "over", " ", "which", " ",
       "to", " ", "sum"}]}], "*)"}], "\n", 
   RowBox[{
    RowBox[{"s1xcoords", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{"s1xvoxgrid", "[", 
             RowBox[{"[", "i", "]"}], "]"}], "[", 
            RowBox[{"[", "j", "]"}], "]"}], ",", 
           RowBox[{
            RowBox[{"s1xvoxgrid", "[", 
             RowBox[{"[", "i", "]"}], "]"}], "[", 
            RowBox[{"[", 
             RowBox[{"j", "+", "1"}], "]"}], "]"}], ",", 
           RowBox[{
            RowBox[{"s1xvoxgrid", "[", 
             RowBox[{"[", 
              RowBox[{"i", "+", "1"}], "]"}], "]"}], "[", 
            RowBox[{"[", "j", "]"}], "]"}], ",", 
           RowBox[{
            RowBox[{"s1xvoxgrid", "[", 
             RowBox[{"[", 
              RowBox[{"i", "+", "1"}], "]"}], "]"}], "[", 
            RowBox[{"[", 
             RowBox[{"j", "+", "1"}], "]"}], "]"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", 
           RowBox[{
            RowBox[{"Dimensions", "[", "s1xvoxgrid", "]"}], "[", 
            RowBox[{"[", "1", "]"}], "]"}], ",", "2"}], "}"}]}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"j", ",", "1", ",", 
         RowBox[{
          RowBox[{"Dimensions", "[", "s1xvoxgrid", "]"}], "[", 
          RowBox[{"[", "2", "]"}], "]"}], ",", "2"}], "}"}]}], "]"}]}], ";"}],
    "\[IndentingNewLine]", 
   RowBox[{"Dimensions", "[", "s1xcoords", "]"}]}]}]], "Input",
 CellChangeTimes->{{3.91631183332594*^9, 3.9163118678138766`*^9}, {
   3.9163126440026283`*^9, 3.9163126869518633`*^9}, {3.9163135342979097`*^9, 
   3.916313598763576*^9}, {3.9163159677009945`*^9, 3.91631597171422*^9}, {
   3.9163160171202865`*^9, 3.916316028395404*^9}, {3.916347156776779*^9, 
   3.9163471571787896`*^9}, {3.9172097301022153`*^9, 
   3.9172098026508155`*^9}, {3.9172744517076983`*^9, 
   3.9172744923055863`*^9}, {3.917281026316825*^9, 3.9172810280540667`*^9}, {
   3.9172869954639254`*^9, 3.9172869994706573`*^9}, {3.917290283289502*^9, 
   3.917290285423396*^9}, {3.9172989501544576`*^9, 3.9172989528419933`*^9}, {
   3.917299004065763*^9, 3.9172990095238113`*^9}, {3.917380979564468*^9, 
   3.917380983704131*^9}, {3.917382026700205*^9, 3.9173820437833147`*^9}, {
   3.9179637715972276`*^9, 3.917963858809705*^9}, {3.91796395278442*^9, 
   3.9179639571160336`*^9}, {3.9179710744859495`*^9, 
   3.9179710829065485`*^9}, {3.919079863954933*^9, 3.919079867170043*^9}, {
   3.9201083878115163`*^9, 3.920108420452963*^9}, {3.920403070886611*^9, 
   3.9204030736205716`*^9}, {3.9204031506088233`*^9, 3.920403157495184*^9}, 
   3.9204032387006288`*^9},ExpressionUUID->"c7b91d31-707f-477e-b925-\
adea415abcd5"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"50", ",", "50", ",", "4", ",", "2"}], "}"}]], "Output",
 CellChangeTimes->{3.9179711227848454`*^9, 3.919079870650076*^9, 
  3.9204031736333237`*^9},
 CellLabel->
  "Out[615]=",ExpressionUUID->"d1baa8a5-1900-4be5-92cd-14fb10cc4173"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "calculate", " ", "the", " ", "reinmann", " ", "sum", " ", "over", " ", 
    "each", " ", "voxel", " ", "in", " ", "an", " ", "axial", " ", "slice", 
    " ", "of", " ", "the", " ", "center", " ", "of", " ", "the", " ", "mesh", 
    " ", "volume"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"sx", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"Total", "[", 
          RowBox[{
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"Table", "[", 
              RowBox[{
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"EuclideanDistance", "[", 
                   RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"s1xcoords", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "[", 
                    RowBox[{"[", "j", "]"}], "]"}], "[", 
                    RowBox[{"[", "k", "]"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", "0"}], "}"}]}], "]"}], "<", 
                  RowBox[{"r", "-", "10"}]}], ",", 
                 RowBox[{
                  RowBox[{"patternarray", "[", 
                   RowBox[{"[", "l", "]"}], "]"}], "*", 
                  FractionBox[
                   RowBox[{"(", 
                    RowBox[{"dxx", "*", "dyy"}], ")"}], "4"]}], ",", "0"}], 
                "]"}], ",", 
               RowBox[{"{", 
                RowBox[{"x", ",", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{
                    RowBox[{
                    RowBox[{"s1xcoords", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "[", 
                    RowBox[{"[", "j", "]"}], "]"}], "[", 
                    RowBox[{"[", "k", "]"}], "]"}], "[", 
                   RowBox[{"[", "1", "]"}], "]"}], "}"}]}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"y", ",", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{
                    RowBox[{
                    RowBox[{"s1xcoords", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "[", 
                    RowBox[{"[", "j", "]"}], "]"}], "[", 
                    RowBox[{"[", "k", "]"}], "]"}], "[", 
                   RowBox[{"[", "2", "]"}], "]"}], "}"}]}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"z", ",", 
                 RowBox[{"{", 
                  FractionBox["azmax", "2"], "}"}]}], "}"}]}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"k", ",", "1", ",", "4", ",", "1"}], "}"}]}], "]"}], 
           ",", "4"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", "50", ",", "1"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"j", ",", "1", ",", "50", ",", "1"}], "}"}]}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"l", ",", "1", ",", "120", ",", "1"}], "}"}]}], "]"}]}], 
    ";"}], "//", "AbsoluteTiming"}]}]], "Input",
 CellChangeTimes->{{3.9159708057696123`*^9, 3.915970856027762*^9}, {
   3.9159710497711945`*^9, 3.915971050162736*^9}, {3.9159710950213127`*^9, 
   3.9159711160379477`*^9}, {3.9159715854860096`*^9, 
   3.9159715986010437`*^9}, {3.9159913515522013`*^9, 
   3.9159913802604113`*^9}, {3.9159914944530306`*^9, 
   3.9159915256661468`*^9}, {3.9159919230673485`*^9, 3.915991926267417*^9}, {
   3.9163081222211256`*^9, 3.9163081402531595`*^9}, 3.916308189123069*^9, {
   3.9163094469039583`*^9, 3.9163095087692814`*^9}, {3.916309562166769*^9, 
   3.916309566896581*^9}, {3.9163096267516613`*^9, 3.916309630378326*^9}, {
   3.9163096820619526`*^9, 3.9163096878336945`*^9}, {3.916312747642171*^9, 
   3.9163127493078346`*^9}, {3.9163128004203653`*^9, 
   3.9163128101367655`*^9}, {3.9163128580813427`*^9, 3.916312936424828*^9}, {
   3.916313675982439*^9, 3.916313677093899*^9}, {3.916316458833744*^9, 
   3.916316537313589*^9}, {3.916316638650813*^9, 3.9163166528859167`*^9}, {
   3.9163171261159115`*^9, 3.9163171772817984`*^9}, {3.91631729676416*^9, 
   3.916317304762911*^9}, {3.9163173528784633`*^9, 3.916317353952533*^9}, {
   3.916318008828912*^9, 3.916318019377388*^9}, {3.9163180615755234`*^9, 
   3.9163180639217515`*^9}, {3.916318672446748*^9, 3.916318682371789*^9}, {
   3.916318809515977*^9, 3.9163188357521844`*^9}, 3.9163189964010196`*^9, {
   3.9163190682093763`*^9, 3.9163190842788105`*^9}, {3.916319119131198*^9, 
   3.916319131351807*^9}, {3.9163193392088933`*^9, 3.916319358935441*^9}, {
   3.9163197864086637`*^9, 3.9163198872954135`*^9}, {3.9163199287167826`*^9, 
   3.9163199993502617`*^9}, {3.9163200338032827`*^9, 
   3.9163200604436502`*^9}, {3.9163202081282125`*^9, 
   3.9163202418840866`*^9}, {3.9163203158847723`*^9, 
   3.9163203719057145`*^9}, {3.916320461898388*^9, 3.916320483773507*^9}, {
   3.9163205405793085`*^9, 3.916320540775292*^9}, {3.916321125654567*^9, 
   3.9163211537762947`*^9}, {3.9163212077009916`*^9, 
   3.9163212126178474`*^9}, {3.9163216118356047`*^9, 
   3.9163216126125317`*^9}, {3.916327973816597*^9, 3.9163279888325925`*^9}, {
   3.9163280229032173`*^9, 3.916328071153788*^9}, {3.9163281655536385`*^9, 
   3.9163281657221985`*^9}, {3.916328226406374*^9, 3.916328226557089*^9}, {
   3.916328375498721*^9, 3.916328384850136*^9}, {3.9163287644750657`*^9, 
   3.9163287649166927`*^9}, 3.9163471123625746`*^9, {3.9163473659689465`*^9, 
   3.916347383738888*^9}, {3.9163967480310783`*^9, 3.9163967487075195`*^9}, {
   3.9172238023388963`*^9, 3.917223811867193*^9}, {3.917261654472748*^9, 
   3.917261656968142*^9}, {3.917274520283036*^9, 3.9172745236077714`*^9}, {
   3.91728104541392*^9, 3.91728105171316*^9}, {3.917281484354005*^9, 
   3.9172814848184853`*^9}, {3.9172815931687436`*^9, 3.917281593277571*^9}, {
   3.9172850864981594`*^9, 3.9172851048901434`*^9}, {3.9172870157446327`*^9, 
   3.9172870441781797`*^9}, 3.917287527280055*^9, {3.917287610398037*^9, 
   3.91728761080661*^9}, {3.917287778567251*^9, 3.917287778683483*^9}, {
   3.917287809231802*^9, 3.9172878281494813`*^9}, {3.917289848882024*^9, 
   3.917289852129902*^9}, {3.917289931457532*^9, 3.9172899316210957`*^9}, {
   3.917290246037013*^9, 3.9172902506812716`*^9}, {3.9172903008382797`*^9, 
   3.9172903047455673`*^9}, {3.917299032047707*^9, 3.9172990380178185`*^9}, {
   3.9179709076023483`*^9, 3.917970910938795*^9}, {3.9179711009777217`*^9, 
   3.917971104237276*^9}, {3.9201084618786445`*^9, 3.920108485583881*^9}, {
   3.920403430349511*^9, 
   3.9204034522208176`*^9}},ExpressionUUID->"2b5bf154-1b2b-4c69-a2bd-\
ea24d2a20be2"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"10459.7839941`", ",", "Null"}], "}"}]], "Output",
 CellChangeTimes->{
  3.917223775368967*^9, 3.917223918213154*^9, 3.9172746231412477`*^9, 
   3.9172811299029217`*^9, 3.9172815681200542`*^9, 3.9172816615420775`*^9, 
   3.9172852381770864`*^9, 3.9172874171893787`*^9, 3.9172875531706877`*^9, 
   3.917287638136051*^9, {3.917287806644819*^9, 3.9172878315650034`*^9}, 
   3.917289921868037*^9, 3.9172901632544203`*^9, 3.9172988546935263`*^9, 
   3.9173041624217567`*^9, 3.9173167800590844`*^9, 3.917969642844204*^9, 
   3.9179816071192102`*^9},
 CellLabel->"Out[95]=",ExpressionUUID->"404d889f-71d9-48c8-8014-659ccbc2b3f5"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "visualize", " ", "the", " ", "sensitivity", " ", "maps", " ", "of", " ", 
    "the", " ", "120", " ", "unique", " ", "electrode", " ", "pairings"}], 
   "*)"}], "\[IndentingNewLine]", 
  RowBox[{"Map", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"ArrayPlot", "[", 
      RowBox[{"#", ",", 
       RowBox[{"ColorFunction", "->", "\"\<Rainbow\>\""}]}], "]"}], "&"}], 
    ",", "sx"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.916318758689146*^9, 3.9163187627734966`*^9}, {
   3.91631938108729*^9, 3.9163193832432966`*^9}, {3.9163204998144717`*^9, 
   3.916320510251853*^9}, {3.9163205561377645`*^9, 3.9163205598335977`*^9}, {
   3.916328553914031*^9, 3.91632856101196*^9}, {3.916328616365833*^9, 
   3.91632865138188*^9}, {3.9163287256381693`*^9, 3.916328755404023*^9}, {
   3.9163290824872446`*^9, 3.9163290832045574`*^9}, 3.9172852523647842`*^9, {
   3.920108495411668*^9, 
   3.920108521828928*^9}},ExpressionUUID->"19b9f061-2afa-4728-8638-\
ac51c428e319"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "initialize", " ", "the", " ", "sensitivity", " ", "matrix", " ", "s", " ",
     "and", " ", "its", " ", "transpose", " ", 
    RowBox[{"st", ".", " ", "Define"}], " ", "imaging", " ", "area", " ", 
    "pixel", " ", "dimensions"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"s", "=", 
     RowBox[{"Flatten", "/@", " ", "sx"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"st", "=", 
     RowBox[{"Transpose", "[", "s", "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"pxcolumns", "=", 
     RowBox[{
      RowBox[{"Dimensions", "[", "s1xcoords", "]"}], "[", 
      RowBox[{"[", "1", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"pxrows", "=", 
     RowBox[{
      RowBox[{"Dimensions", "[", "s1xcoords", "]"}], "[", 
      RowBox[{"[", "2", "]"}], "]"}]}], ";"}]}]}]], "Input",
 CellChangeTimes->{{3.9163320578284473`*^9, 3.916332152528593*^9}, {
  3.916333655193473*^9, 3.9163336565915356`*^9}, {3.917344396498372*^9, 
  3.9173444071408634`*^9}, {3.9173448730348806`*^9, 3.9173448759552813`*^9}, {
  3.9173449416577063`*^9, 3.917344950989296*^9}, {3.9179845445844307`*^9, 
  3.9179845471467094`*^9}, {3.9201086561846027`*^9, 3.9201086939909525`*^9}, {
  3.9204032556594486`*^9, 
  3.92040326470835*^9}},ExpressionUUID->"0337e4cc-56f2-46bf-9f6f-\
393cbca4ec6a"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"create", " ", "a", " ", "phantom"}], ",", " ", 
    RowBox[{
    "define", " ", "the", " ", "parameter", " ", "for", " ", "regularization",
      " ", 
     RowBox[{"(", "l", ")"}]}], ",", " ", 
    RowBox[{
    "and", " ", "reconstruct", " ", "phantom", " ", "using", " ", "both", " ",
      "linear", " ", "back", " ", "projection", " ", "and", " ", "Tikhonov", 
     " ", "regularization"}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "adjust", " ", "values", " ", "to", " ", "move", " ", "phantom", " ", 
    "and", " ", "change", " ", "the", " ", "size"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"rp", "=", "70"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"posx", "=", 
     RowBox[{"-", "55"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"posy", "=", 
     RowBox[{"-", "10"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"phantom", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"Total", "[", 
        RowBox[{
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"EuclideanDistance", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{
                    RowBox[{"s1xcoords", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "[", 
                    RowBox[{"[", "j", "]"}], "]"}], "[", 
                   RowBox[{"[", "k", "]"}], "]"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"posx", ",", "posy"}], "}"}]}], "]"}], "<", "rp"}],
                ",", "1", ",", "0"}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"x", ",", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{
                  RowBox[{
                   RowBox[{"s1xcoords", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "[", 
                   RowBox[{"[", "j", "]"}], "]"}], "[", 
                  RowBox[{"[", "k", "]"}], "]"}], "[", 
                 RowBox[{"[", "1", "]"}], "]"}], "}"}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"y", ",", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{
                  RowBox[{
                   RowBox[{"s1xcoords", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "[", 
                   RowBox[{"[", "j", "]"}], "]"}], "[", 
                  RowBox[{"[", "k", "]"}], "]"}], "[", 
                 RowBox[{"[", "2", "]"}], "]"}], "}"}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"z", ",", 
               RowBox[{"{", 
                FractionBox["azmax", "2"], "}"}]}], "}"}]}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"k", ",", "1", ",", "4", ",", "1"}], "}"}]}], "]"}], ",", 
         "4"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", "50", ",", "1"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"j", ",", "1", ",", "50", ",", "1"}], "}"}]}], "]"}]}], ";"}],
    "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"l", "=", "0.000000000000001"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"cvector", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"Dot", "[", 
        RowBox[{
         RowBox[{"Flatten", "[", 
          RowBox[{"Rescale", "[", "phantom", "]"}], "]"}], ",", 
         RowBox[{"s", "[", 
          RowBox[{"[", "i", "]"}], "]"}]}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", "120", ",", "1"}], "}"}]}], "]"}]}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"QTik", "=", 
     RowBox[{"Dot", "[", 
      RowBox[{"st", ",", 
       RowBox[{"Inverse", "[", 
        RowBox[{
         RowBox[{"Dot", "[", 
          RowBox[{"s", ",", "st"}], "]"}], "+", 
         RowBox[{"l", "*", 
          RowBox[{"IdentityMatrix", "[", 
           RowBox[{"{", 
            RowBox[{"120", ",", "120"}], "}"}], "]"}]}]}], "]"}]}], "]"}]}], 
    ";"}], "\n", 
   RowBox[{
    RowBox[{"glbp", "=", 
     RowBox[{"ArrayReshape", "[", 
      RowBox[{
       RowBox[{"Rescale", "[", 
        RowBox[{"Dot", "[", 
         RowBox[{"st", ",", "cvector"}], "]"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"pxcolumns", ",", "pxrows"}], "}"}]}], "]"}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{"gtik", "=", 
     RowBox[{"ArrayReshape", "[", 
      RowBox[{
       RowBox[{"Rescale", "[", 
        RowBox[{"Dot", "[", 
         RowBox[{"QTik", ",", "cvector"}], "]"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"pxcolumns", ",", "pxrows"}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"cf", "=", "\"\<TemperatureMap\>\""}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"GraphicsGrid", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"ArrayPlot", "[", 
         RowBox[{"phantom", ",", 
          RowBox[{"ColorFunction", "->", "cf"}], ",", 
          RowBox[{"FrameLabel", "->", "\"\<Original\>\""}]}], "]"}], ",", 
        RowBox[{"ArrayPlot", "[", 
         RowBox[{"gtik", ",", 
          RowBox[{"ColorFunction", "->", "cf"}], ",", 
          RowBox[{"FrameLabel", "->", "\"\<Tikhonov\>\""}]}], "]"}]}], "}"}], 
      ",", 
      RowBox[{"{", 
       RowBox[{"ArrayPlot", "[", 
        RowBox[{"glbp", ",", 
         RowBox[{"ColorFunction", "->", "cf"}], ",", 
         RowBox[{"FrameLabel", "->", "\"\<LBP\>\""}]}], "]"}], "}"}]}], "}"}],
     "]"}]}]}]], "Input",
 CellChangeTimes->{{3.917344748950322*^9, 3.917344783776058*^9}, {
   3.9173448180273924`*^9, 3.9173448652603717`*^9}, 3.9173449322624493`*^9, {
   3.917345024785894*^9, 3.9173450628653946`*^9}, {3.917984599201788*^9, 
   3.917984667560357*^9}, {3.9179847915246987`*^9, 3.917984798059864*^9}, {
   3.9179872960982056`*^9, 3.9179872962784915`*^9}, {3.9179962297498083`*^9, 
   3.9179962990412073`*^9}, {3.9201086999954004`*^9, 
   3.9201087688779244`*^9}, {3.920108936761723*^9, 3.9201089510430317`*^9}, {
   3.9204033017675924`*^9, 
   3.9204033845976925`*^9}},ExpressionUUID->"7a01673c-b39c-41d7-ad13-\
0435af584313"],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.91807425594283*^9, 
  3.9180742623839064`*^9}},ExpressionUUID->"80f5f25c-dc2c-498e-b174-\
f384c7e57ddd"]
},
WindowSize->{1141.2, 574.8},
WindowMargins->{{
  Automatic, -3.599999999999909}, {-4.199999999999932, Automatic}},
Magnification:>0.6 Inherited,
FrontEndVersion->"13.3 for Microsoft Windows (64-bit) (June 3, 2023)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"d448b834-74d7-4b7a-80c9-bc77b54473ac"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 5238, 121, 166, "Input",ExpressionUUID->"f26d7497-0a07-45ef-90a2-712c1a135654"],
Cell[5799, 143, 693, 16, 42, "Input",ExpressionUUID->"1db33636-8368-4bc8-8f65-a9dcdd91192b"],
Cell[6495, 161, 4573, 113, 63, "Input",ExpressionUUID->"e784b316-4fa1-4a69-b781-ec7c27e6dae1"],
Cell[11071, 276, 2115, 59, 55, "Input",ExpressionUUID->"c0d84ba2-6dec-4d4c-a0a7-633e9cb56c48"],
Cell[CellGroupData[{
Cell[13211, 339, 1472, 34, 29, "Input",ExpressionUUID->"4e29b1e1-09ae-4d27-bea7-d54cbcf6a274"],
Cell[14686, 375, 372, 6, 22, "Output",ExpressionUUID->"a266469a-358b-4ce5-b755-2f3f4f237f5e"]
}, Open  ]],
Cell[15073, 384, 1783, 40, 40, "Input",ExpressionUUID->"49f166a6-2040-4495-af71-4deb41679c49"],
Cell[16859, 426, 1222, 31, 29, "Input",ExpressionUUID->"909a61a5-e4b5-4da4-9835-8bda6d13342a"],
Cell[18084, 459, 2772, 65, 42, "Input",ExpressionUUID->"d0eb7bf3-dbba-426c-a3c7-465c623d1e52"],
Cell[CellGroupData[{
Cell[20881, 528, 4036, 93, 97, "Input",ExpressionUUID->"c7b91d31-707f-477e-b925-adea415abcd5"],
Cell[24920, 623, 271, 6, 30, "Output",ExpressionUUID->"d1baa8a5-1900-4be5-92cd-14fb10cc4173"]
}, Open  ]],
Cell[CellGroupData[{
Cell[25228, 634, 6679, 128, 60, "Input",ExpressionUUID->"2b5bf154-1b2b-4c69-a2bd-ea24d2a20be2"],
Cell[31910, 764, 661, 11, 22, "Output",ExpressionUUID->"404d889f-71d9-48c8-8014-659ccbc2b3f5"]
}, Open  ]],
Cell[32586, 778, 1014, 22, 29, "Input",ExpressionUUID->"19b9f061-2afa-4728-8638-ac51c428e319"],
Cell[33603, 802, 1399, 32, 63, "Input",ExpressionUUID->"0337e4cc-56f2-46bf-9f6f-393cbca4ec6a"],
Cell[35005, 836, 6270, 164, 167, "Input",ExpressionUUID->"7a01673c-b39c-41d7-ad13-0435af584313"],
Cell[41278, 1002, 153, 3, 19, "Input",ExpressionUUID->"80f5f25c-dc2c-498e-b174-f384c7e57ddd"]
}
]
*)

